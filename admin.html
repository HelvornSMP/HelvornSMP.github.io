<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Helvorn Admin Crate Checker</title>

<style>
body{
background:#0b0b0b;
color:#eaeaea;
font-family:system-ui;
display:flex;
justify-content:center;
align-items:center;
height:100vh;
margin:0;
}

.card{
background:#141414;
padding:40px;
border-radius:18px;
width:420px;
box-shadow:0 10px 40px rgba(0,0,0,.5);
text-align:center;
}

h1{
color:#c9b458;
margin-bottom:20px;
}

input{
width:100%;
padding:14px;
border-radius:10px;
border:none;
margin-bottom:15px;
font-size:16px;
background:#0f0f0f;
color:white;
}

button{
width:100%;
padding:14px;
border-radius:10px;
border:none;
background:#c9b458;
color:black;
font-weight:bold;
cursor:pointer;
}

#result{
margin-top:20px;
font-size:15px;
line-height:1.6;
}

.valid{color:#55ff55;}
.invalid{color:#ff5555;}
.info{color:#55ffff;}

</style>
</head>

<body>

<div class="card">

<h1>üõ° Crate Code Checker</h1>

<input id="codeInput" placeholder="Paste crate code here">

<button onclick="verifyCode()">Verify Code</button>

<div id="result"></div>

</div>

<script>

// üî¥ PASTE YOUR GOOGLE SCRIPT URL HERE
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxwzBQxqq4U2De5tbbEELIsQen5l4WHHiCVw_teaqYq9VVPXmYXpR_x9t5SfhbcmlMl/exec";

async function verifyCode(){

const code = document.getElementById("codeInput").value.trim();
const result = document.getElementById("result");

// ===== Basic format validation =====
if(!code.startsWith("HEL-")){
result.innerHTML = `<span class="invalid">‚ùå Invalid Helvorn code format</span>`;
return;
}

const parts = code.split("-");

if(parts.length < 5){
result.innerHTML = `<span class="invalid">‚ùå Broken code format</span>`;
return;
}

// ===== Extract info from code =====
const time = parts[1];
const rarity = parts[2];
const item = parts[3];

// ===== Check Google Sheet =====
try{

const res = await fetch(SCRIPT_URL + "?check=" + encodeURIComponent(code));
const data = await res.json();

if(data.status === "claimed"){

result.innerHTML = `
<span class="invalid">‚ö† Code Already Claimed</span><br><br>
<span class="info">Item:</span> ${data.item}<br>
<span class="info">Rarity:</span> ${data.rarity}<br>
<span class="info">Player:</span> ${data.player}<br>
<span class="info">Time:</span> ${data.timestamp}
`;

}else{

result.innerHTML = `
<span class="valid">‚úÖ Code Valid & Unclaimed</span><br><br>
<span class="info">Item:</span> ${item}<br>
<span class="info">Rarity:</span> ${rarity}<br>
<span class="info">Generated:</span> ${time}
`;

}

}catch(err){
result.innerHTML = `<span class="invalid">‚ùå Database connection failed</span>`;
}

}

</script>

</body>
</html>

